---
import { awards } from "../../data/awards";

// We disregard the passed props for now as we are overriding this section entirely based on user request.
interface Props {
  t: any; 
  lang?: string;
}

const { t, lang = "es" } = Astro.props;

const currentLang = lang === "en" ? "en" : "es";

const content = {
  es: {
    header: "SALÓN DE LA FAMA",
    title: "RECONOCIMIENTOS",
    subtitle: "Probabilidad, Ajedrez & Código"
  },
  en: {
    header: "HALL OF FAME",
    title: "RECOGNITIONS",
    subtitle: "Probability, Chess & Code"
  }
};

const tContent = content[currentLang];
---

<section class="w-full py-24 px-4 bg-void text-paper border-t border-white/5" id="benchmarks">
  <div class="max-w-[1920px] mx-auto">
    <!-- Header -->
    <div class="max-w-7xl mx-auto mb-16 px-4 md:px-12">
      <p class="font-mono text-acid text-sm tracking-widest mb-2">{tContent.header}</p>
      <h2 class="font-display text-5xl md:text-7xl text-white mb-4">
        {tContent.title}
        <span class="italic font-light text-white/30 block md:inline md:ml-4 text-3xl md:text-5xl">{tContent.subtitle}</span>
      </h2>
    </div>

    <!-- Cover Flow Container -->
    <ul 
        id="awards-container"
        class="cards py-24 px-[calc(50vw-150px)] md:px-[calc(50vw-150px)]"
    >
      {awards.map((award) => (
        <li class="card-item group">
            <div class="cover-wrapper bg-zinc-950 border border-white/10 rounded-sm overflow-hidden h-full flex flex-col">
               <!-- Image -->
               <div class="relative w-full flex-1 min-h-0 border-b border-white/5 overflow-hidden">
                    <div class="absolute inset-0 bg-linear-to-t from-black/80 via-transparent to-transparent opacity-40 z-10 pointer-events-none"></div>
                    <img 
                        src={award.image} 
                        alt={award.title[currentLang as 'en' | 'es']} 
                        loading="lazy"
                        class="w-full h-full object-cover object-top cursor-zoom-in"
                        onclick={`window.openAwardModal('${award.image}')`}
                    />
               </div>

               <!-- Content -->
               <div class="p-4 flex flex-col justify-end bg-zinc-950 h-auto z-20 pointer-events-none">
                    <div>
                        <span class="font-mono text-[10px] text-acid bg-acid/10 px-1.5 py-0.5 rounded-sm block w-fit mb-2">{award.date}</span>
                        <h3 class="font-display text-lg text-white leading-tight mb-2">{award.title[currentLang as 'en' | 'es']}</h3>
                    </div>
                    <p class="font-sans text-white text-xs leading-relaxed">{award.description[currentLang as 'en' | 'es']}</p>
               </div>
            </div>
        </li>
      ))}
    </ul>
  </div>

  <!-- Award Lightbox Modal -->
  <div id="award-modal" class="fixed inset-0 z-[9999] bg-black/90 backdrop-blur-xl hidden opacity-0 transition-opacity duration-300 items-center justify-center p-4 md:p-12" onclick="window.closeAwardModal()">
      <div class="relative max-w-full max-h-full">
           <img id="award-modal-img" src="" class="max-w-full max-h-[90vh] object-contain rounded-sm shadow-2xl border border-white/10" />
           <p class="text-white/50 text-xs font-mono text-center mt-4">[CLICK ANYWHERE TO CLOSE]</p>
      </div>
  </div>
</section>

<script is:inline>
    // --- Hover Scroll Logic ---
    const slider = document.getElementById('awards-container');
    let animationFrameId;
    let scrollSpeed = 0;
    
    const MAX_SPEED = 7; // Lento speed
    const ZONE_PERCENT = 0.25; // Active zones width (25% on each side)

    slider.addEventListener('mousemove', (e) => {
        const rect = slider.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const width = rect.width;

        // Reset speed
        scrollSpeed = 0;

        // Check Left Zone
        if (x < width * ZONE_PERCENT) {
             const intensity = 1 - (x / (width * ZONE_PERCENT)); // 0 to 1
             scrollSpeed = -MAX_SPEED * intensity;
        }
        // Check Right Zone
        else if (x > width * (1 - ZONE_PERCENT)) {
             const intensity = (x - width * (1 - ZONE_PERCENT)) / (width * ZONE_PERCENT); // 0 to 1
             scrollSpeed = MAX_SPEED * intensity;
        }
    });

    slider.addEventListener('mouseleave', () => {
        scrollSpeed = 0;
    });

    // Animation Loop
    function animateScroll() {
        if (scrollSpeed !== 0) {
            slider.scrollLeft += scrollSpeed;
        }
        animationFrameId = requestAnimationFrame(animateScroll);
    }
    
    // Start loop
    animateScroll();


    // --- Modal Logic ---
    const modal = document.getElementById('award-modal');
    const modalImg = document.getElementById('award-modal-img');

    window.openAwardModal = (imageSrc) => {
        modalImg.src = imageSrc;
        modal.classList.remove('hidden');
        modal.classList.add('flex'); // Add flex to center
        setTimeout(() => {
            modal.classList.remove('opacity-0');
        }, 10);
        document.body.style.overflow = 'hidden';
    };

    window.closeAwardModal = () => {
        modal.classList.add('opacity-0');
        setTimeout(() => {
            modal.classList.remove('flex'); // Remove flex
            modal.classList.add('hidden');
            modalImg.src = '';
            document.body.style.overflow = '';
        }, 300);
    };
</script>

<style>
  .cards {
    display: flex;
    list-style: none;
    overflow-x: auto;
    /* Removed scroll-snap to allow free smooth hover scrolling */
    /* scroll-snap-type: x mandatory; */ 
    gap: 0;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .cards::-webkit-scrollbar {
    display: none;
  }

  .card-item {
    flex: 0 0 300px;
    width: 300px;
    height: 420px; /* Reduced from 500px as requested */
    /* Removed snap align */
    /* scroll-snap-align: center; */
    perspective: 1000px;
    
    view-timeline-name: --li-in-and-out-of-view;
    view-timeline-axis: inline;

    animation: linear adjust-z-index both;
    animation-timeline: --li-in-and-out-of-view;
  }

  .cover-wrapper {
    width: 100%;
    height: 100%;
    margin: 10px 0;
    
    -webkit-box-reflect: below 10px linear-gradient(transparent, transparent, rgba(0,0,0,0.4));
    
    animation: linear rotate-cover both;
    animation-timeline: --li-in-and-out-of-view;
  }

  @keyframes adjust-z-index {
    0% { z-index: 1; }
    50% { z-index: 100; }
    100% { z-index: 1; }
  }

  @keyframes rotate-cover {
    0% {
        transform: translateX(-50%) rotateY(-45deg) scale(0.85);
    }
    35% {
        transform: translateX(0) rotateY(-45deg) scale(0.85);
    }
    50% {
        transform: rotateY(0deg) translateZ(50px) scale(1.1);
        box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        border-color: rgba(255, 255, 255, 0.3);
    }
    65% {
        transform: translateX(0) rotateY(45deg) scale(0.85);
    }
    100% {
        transform: translateX(50%) rotateY(45deg) scale(0.85);
    }
  }
</style>
